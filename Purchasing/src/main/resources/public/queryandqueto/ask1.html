<html>
<head>
<meta http-equiv="Content-Language" content="zh-cn">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css"  href="../jquery-easyui-1.8.5\themes\default\easyui.css"/>
    <link rel="stylesheet" type="text/css" href="../jquery-easyui-1.8.5/themes/icon.css"/>
    <script type="text/javascript" src="../jquery-easyui-1.8.5/jquery.min.js"></script>
    <script type="text/javascript" src="../jquery-easyui-1.8.5/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="../jquery-easyui-1.8.5\locale\easyui-lang-zh_CN.js"></script>
    <script type="text/javascript">
        $(function () {
            $("#dg").datagrid({
                url: "/InquiryList",
                pagination: 'true',
                rownumbers: 'true',
                selectOnCheck: 'true',
                singleSelect: 'true',
                checkOnSelect: 'true',
                pageList: [2, 4, 6, 8, 10],
                columns: [[
                    {field: '', title: '', width: 120, checkbox: true, align: 'center'},
                    {field: 'enquireName', title: '询价书名称', width: 250, align: 'center'},
                    {field: 'startDate', title: '询价开始时间', width: 220, align: 'center'},
                    {field: 'endDate', title: '询价截至时间', width: 250, align: 'center'},
                    {field: 'status', title: '询价书状态', width: 220, align: 'center',formatter:function (value,row,index) {
                            if(value=="C001-70"){
                                 return "未发布";
                            }else if(value=="C001-80"){
                                return "未揭示";
                            }else if(value=="C001-100"){
                                return "已揭示";
                            }else{
                                return "已截止";
                            }
                        }},
                    {field: 'stockType', title: '采购类型', width: 280, align: 'center'},
                    {field: 'eid', title: '询价id', hidden: true},
                    {field: 'imId', title: '状态id', hidden: true}
                ]]
            });
        });
        function update_quote()
        {
            var rows= $("#dg").datagrid("getSelections");
            if(rows.length==0 || rows.length==null){
                alert("请选中一条数据！");
            }else if(rows[0].status=="C001-80"){
                alert("已发布询价不能修改！");
            }else if(rows[0].status=="C001-100"){
                alert("已揭示询价不能修改！");
            }else if(rows[0].status=="C001-70"){
                //alert(rows[0].eid+":"+rows[0].imId);
                location.href="/findEnquireById?eid="+rows[0].eid+"&imId="+rows[0].imId;
            }else{
                alert("已截止询价不能修改！");
            }

        }
        function delete_quote()
        {
			var rows= $("#dg").datagrid("getSelections");
			if(rows.length==0 || rows.length==null){
				alert("请选中一条数据！");
			}else if(rows.length>1){
				alert("一次只能选择一条数据！");
			}else{
				$.ajax({
					url:"/deleteEnquire",
					type:"post",
					data:{
						"eid":rows[0].eid,
						"imId":rows[0].imId
					},
					success:function (data) {
						if(data=="true"){
							alert("删除成功！");
							$("#dg").datagrid("reload");
						}else{
							alert("删除失败！");
							$("#dg").datagrid("reload");
						}
					}
				});
			}
        }

    </script>
</HEAD>
<title>询价书列表</title>
<BODY>
<form name=form >
<input type="hidden" name="p_opert" value="3">

<TABLE style="LINE-HEIGHT: 30px" cellSpacing=1 cellPadding=0     width="100%"  bgColor=#336699 borderColorLight=#006699 border=0>
<tr>
<td>
<table cellpadding="3" cellspacing="1" border="0" width="100%">
<tr bgcolor="#ffffff"> 
<td width="100%" colspan="20" bgcolor="#ffffff" align=center height=22><B><H2><font  color=#0070C0 >询价书列表</br>
<a href="javascript:void(null)" onClick="window.open('../help/Help.asp?Value=询价未截止报价书列表','child','status=NO,scrollbars=yes,toolbar=no,menubar=no,location=no,left=200,top=100,width=700,height=400')" ><img alt="帮助" src="Img/help_a.gif" border="0"></a>
</td>
</tr>
<tr><td colspan="6" align="center">
 <table>
			<tr>
			 <td>
			 询价书名称:<input type="text"/>
			 </td>
			 <td>
			 状态:
			 <select>
			 <option>全部</option>
			<option>未发布</option>
			<option>未揭示</option>
			<option>已截止</option>
			<option>已揭示</option>
			 </select>
			 </td>
			 <td>
			 <input type="button" value="查询"/>
			 </td>
			</tr>
			</table>
</td></tr>

</table>
<table id="dg"></table>
</td></tr></table>

</center>
</form>
<P Align=center>
<INPUT onClick=" update_quote();" type="button" name="jbxxlist1"    value="修改询价">
<INPUT onClick=" javascript:delete_quote()" type="button" name="jbxxlist2"     value="删除询价"> 
</p>

</body>
</html>

<script language=javascript>
function app(obj){
	var c=document.getElementById("jbxxlist1");
	c.disabled=obj;
	var c1=document.getElementById("jbxxlist2");
	c1.disabled=obj;
}
      
   </script>
